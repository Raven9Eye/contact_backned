# 代码标准

本代码标准基于 [Node.js 官方风格指南](https://nodejs.org/en/docs/guides/style-guide/) 和 [Airbnb JavaScript 风格指南](https://github.com/airbnb/javascript)。

## JavaScript 规范

1. **变量声明**
   - 使用 `const` 声明不可变变量
   - 使用 `let` 声明可变变量
   - 避免使用 `var`

2. **命名规范**
   - 变量和函数使用驼峰命名法（如 `getContacts()`）
   - 常量使用全大写加下划线（如 `API_PORT`）
   - 类名使用帕斯卡命名法（如 `ContactService`）
   - 文件和目录使用小写，单词之间用短横线分隔（如 `contact-routes.js`）

3. **函数**
   - 使用箭头函数作为回调和匿名函数
   - 函数参数不宜过多（建议不超过 4 个）
   - 对异步函数使用 async/await

4. **注释**
   - 为模块添加文件级注释
   - 为复杂逻辑和关键函数添加注释
   - 使用 JSDoc 注释描述函数参数、返回值和抛出的异常

5. **格式**
   - 缩进使用 2 个空格
   - 每行不超过 100 个字符
   - 语句结束使用分号
   - 花括号使用 K&R 风格（左花括号在同一行）

## Node.js 特定规范

1. **模块导入/导出**
   - 使用 ES6 模块语法 (`import`/`export`)
   - 导入语句按顺序排列（内置模块、第三方模块、自定义模块）

2. **错误处理**
   - 使用 try-catch 处理同步错误
   - 正确处理 Promise 错误（使用 catch 或 try-catch with await）
   - 实现统一的错误处理中间件

3. **异步操作**
   - 优先使用 async/await 而非回调
   - 避免回调地狱
   - 正确处理 Promise 链

4. **HTTP 状态码**
   - 200: OK - 成功的 GET 请求
   - 201: Created - 成功创建资源
   - 204: No Content - 成功但无内容返回
   - 400: Bad Request - 请求参数错误
   - 404: Not Found - 资源不存在
   - 500: Internal Server Error - 服务器内部错误

## Express.js 规范

1. **路由组织**
   - 使用 Router 分离路由逻辑
   - 按功能模块组织路由
   - 路由处理函数放在控制器中

2. **中间件**
   - 中间件按合理顺序注册
   - 错误处理中间件放在最后
   - 自定义中间件使用有意义的名称

3. **响应格式**
   - 统一的 JSON 响应格式
   - 成功响应包含 `data` 字段
   - 错误响应包含 `error`、`message` 字段

## 最佳实践

1. **安全性**
   - 验证所有用户输入
   - 使用环境变量存储敏感信息
   - 实施适当的 CORS 策略

2. **性能**
   - 使用适当的缓存策略
   - 避免不必要的计算和数据库查询
   - 使用异步操作避免阻塞

3. **测试**
   - 为关键功能编写单元测试
   - 使用测试框架如 Jest 或 Mocha
   - 测试覆盖主要路径和边界条件

4. **可维护性**
   - 代码模块化，职责单一
   - 使用配置文件管理环境差异
   - 记录日志以便调试和监控